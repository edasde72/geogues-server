<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>GeoGuessr - Poznej zemi podle mapy</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js" crossorigin=""></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body { 
            font-family: 'Segoe UI', system-ui, sans-serif; 
            background: #0f172a;
            color: #e2e8f0;
            line-height: 1.6;
        }
        
        /* Full width layout */
        .section {
            width: 100%;
            padding: 60px 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Hero sekce */
        .hero {
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
            color: white;
            text-align: center;
            padding: 100px 20px;
        }
        
        .hero h1 {
            font-size: clamp(40px, 8vw, 72px);
            margin-bottom: 20px;
            background: linear-gradient(to right, #818cf8, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800;
        }
        
        .hero p {
            font-size: clamp(18px, 3vw, 24px);
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto 40px;
        }
        
        /* Vysvƒõtlen√≠ hry - dlouh√© */
        .how-to-play {
            background: #1e293b;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .section-title h2 {
            font-size: 36px;
            color: #818cf8;
            margin-bottom: 10px;
        }
        
        .section-title p {
            color: #64748b;
            font-size: 18px;
        }
        
        .steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }
        
        .step-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px;
            padding: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .step-card::before {
            content: attr(data-step);
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 48px;
            font-weight: 800;
            color: rgba(129, 140, 248, 0.2);
        }
        
        .step-card h3 {
            color: #818cf8;
            font-size: 22px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .step-card p {
            color: #94a3b8;
            line-height: 1.8;
        }
        
        /* Detailn√≠ pravidla */
        .rules {
            background: #0f172a;
            border-top: 1px solid rgba(255,255,255,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .rule-box {
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 4px solid #818cf8;
        }
        
        .rule-box h3 {
            color: #fff;
            margin-bottom: 10px;
            font-size: 20px;
        }
        
        .rule-box ul {
            margin-left: 20px;
            color: #94a3b8;
        }
        
        .rule-box li {
            margin: 8px 0;
        }
        
        /* Hern√≠ sekce - full width */
        #game-section {
            background: linear-gradient(to bottom, #1e293b, #0f172a);
            min-height: 100vh;
            padding: 40px 20px;
        }
        
        #game-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        /* Menu tlaƒç√≠tka - full width */
        .menu-panel {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
        }
        
        .game-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .game-header h2 {
            font-size: 32px;
            color: #818cf8;
            margin-bottom: 10px;
        }
        
        .btn {
            width: 100%;
            padding: 24px;
            margin-bottom: 15px;
            border: none;
            border-radius: 12px;
            font-size: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
        }
        
        .btn-single {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .btn-multi {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        }
        
        .btn-join {
            background: linear-gradient(135deg, #ec4899 0%, #db2777 100%);
        }
        
        .btn-start {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            font-size: 24px;
            padding: 30px;
            animation: pulse-green 2s infinite;
        }
        
        @keyframes pulse-green {
            0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
            50% { box-shadow: 0 0 20px 10px rgba(16, 185, 129, 0); }
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
        }
        
        /* Hern√≠ plocha */
        #game-panel {
            display: none;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        #map {
            height: 500px;
            background: #242424;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .controls {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 25px;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        input[type="text"] {
            flex: 1;
            padding: 18px 25px;
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 50px;
            background: rgba(0,0,0,0.3);
            color: white;
            font-size: 18px;
            outline: none;
        }
        
        input[type="text"]:focus {
            border-color: #818cf8;
        }
        
        button.action-btn {
            padding: 18px 40px;
            background: linear-gradient(135deg, #818cf8 0%, #c084fc 100%);
            border: none;
            border-radius: 50px;
            color: white;
            font-weight: 700;
            font-size: 16px;
            cursor: pointer;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            background: rgba(0,0,0,0.3);
            padding: 15px 30px;
            border-radius: 12px;
            min-width: 120px;
        }
        
        .stat-label {
            font-size: 12px;
            text-transform: uppercase;
            color: #64748b;
            letter-spacing: 1px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 800;
            color: #818cf8;
        }
        
        /* Lobby */
        .lobby-panel {
            background: rgba(255,255,255,0.05);
            border-radius: 20px;
            padding: 40px;
            display: none;
        }
        
        .code-display {
            font-size: 48px;
            text-align: center;
            letter-spacing: 8px;
            color: #818cf8;
            font-weight: 800;
            background: rgba(0,0,0,0.3);
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            border: 2px dashed #818cf8;
            cursor: pointer;
            font-family: monospace;
        }
        
        .player-list {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            min-height: 150px;
        }
        
        .player-item {
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .host-badge {
            background: #ec4899;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: bold;
        }
        
        /* Autocomplete */
        .autocomplete-items {
            position: absolute;
            width: calc(100% - 140px);
            background: rgba(30, 41, 59, 0.98);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 15px;
            max-height: 250px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            margin-top: 5px;
        }
        
        .autocomplete-item {
            padding: 15px 25px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .autocomplete-item:hover {
            background: rgba(129, 140, 248, 0.2);
        }
        
        /* Game Over */
        #game-over {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.9);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 24px;
            padding: 50px;
            max-width: 600px;
            width: 100%;
            text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }
        
        .modal-content h2 {
            font-size: 36px;
            margin-bottom: 30px;
            color: #fff;
        }
        
        .score-row {
            display: flex;
            justify-content: space-between;
            padding: 15px 20px;
            background: rgba(255,255,255,0.05);
            margin: 10px 0;
            border-radius: 10px;
            font-size: 18px;
        }
        
        .score-row.winner {
            background: rgba(16, 185, 129, 0.2);
            border: 2px solid #10b981;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .section { padding: 40px 20px; }
            .steps { grid-template-columns: 1fr; }
            .menu-panel { padding: 25px; }
            .btn { font-size: 18px; padding: 20px; }
            #map { height: 400px; }
            .code-display { font-size: 32px; letter-spacing: 4px; padding: 20px; }
        }
        
        .hidden { display: none !important; }
        
        /* Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255,255,255,0.1);
            border-top-color: #818cf8;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        
        #map-loader {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            z-index: 1000;
        }
        
        /* Highscore */
        .highscore-box {
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .highscore-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
    </style>
</head>
<body>

<!-- HERO SEKCE -->
<section class="hero">
    <div class="container">
        <h1>üåç GeoGuessr</h1>
        <p>Zapoj sv√© zemƒõpisn√© znalosti a poznej zemi pouze podle satelitn√≠ mapy. Hraj s√≥lo proti ƒçasu nebo vyzvi sv√© p≈ô√°tele v multiplayeru!</p>
    </div>
</section>

<!-- JAK HR√ÅT - Detailn√≠ -->
<section class="how-to-play section">
    <div class="container">
        <div class="section-title">
            <h2>Jak se hraje?</h2>
            <p>Kompletn√≠ pr≈Øvodce hrou krok za krokem</p>
        </div>
        
        <div class="steps">
            <div class="step-card" data-step="01">
                <h3>üéØ Zahaj hru</h3>
                <p>Vyber si mezi Single Player m√≥dem, kde m√°≈° 5 minut na uhodnut√≠ co nejv√≠ce zem√≠, nebo vytvo≈ô multiplayer m√≠stnost a pozvi p≈ô√°tele pomoc√≠ unik√°tn√≠ho k√≥du. Hra je zcela zdarma a nevy≈æaduje registraci.</p>
            </div>
            
            <div class="step-card" data-step="02">
                <h3>üó∫Ô∏è Prozkoumej mapu</h3>
                <p>Na obrazovce se zobraz√≠ satelitn√≠ sn√≠mek nƒõjak√©ho m√≠sta na Zemi. Podle krajiny, mƒõst, silnic nebo p≈ô√≠rodn√≠ch √∫tvar≈Ø se pokus identifikovat, ve kter√© zemi se nach√°z√≠≈°. ƒå√≠m v√≠c p≈ôibl√≠≈æen√≠, t√≠m tƒõ≈æ≈°√≠ h√°danka!</p>
            </div>
            
            <div class="step-card" data-step="03">
                <h3>‚å®Ô∏è Napi≈° odpovƒõƒè</h3>
                <p>Do textov√©ho pole napi≈° n√°zev zemƒõ. M≈Ø≈æe≈° ps√°t ƒçesky (nap≈ô. "ƒåesk√° republika", "Nƒõmecko") nebo anglicky ("Czechia", "Germany"). Syst√©m akceptuje obƒõ varianty i zkr√°cen√© n√°zvy. M√°≈° 5 pokus≈Ø na ka≈ædou zemi.</p>
            </div>
            
            <div class="step-card" data-step="04">
                <h3>‚≠ê Sb√≠rej body</h3>
                <p>Za spr√°vnou odpovƒõƒè z√≠sk√°v√°≈° body - ƒç√≠m rychleji odpov√≠≈°, t√≠m v√≠ce bod≈Ø dostane≈° (max 50 bod≈Ø za prvn√≠ pokus). V multiplayeru vyhr√°v√° kolo ten, kdo odpov√≠ spr√°vnƒõ jako prvn√≠. Sb√≠rej body a sta≈à se ≈°ampionem!</p>
            </div>
        </div>
    </div>
</section>

<!-- PRAVIDLA A TIPY -->
<section class="rules section">
    <div class="container">
        <div class="section-title">
            <h2>Pravidla a tipy</h2>
            <p>V≈°e co pot≈ôebuje≈° vƒõdƒõt pro v√≠tƒõzstv√≠</p>
        </div>
        
        <div class="rule-box">
            <h3>üéÆ Hern√≠ m√≥dy</h3>
            <ul>
                <li><strong>Single Player:</strong> 5 minut ƒçasu, neomezen√Ω poƒçet zem√≠, c√≠lem je nasb√≠rat co nejv√≠ce bod≈Ø. Po skonƒçen√≠ se ulo≈æ√≠ tvoje sk√≥re do ≈æeb≈ô√≠ƒçku.</li>
                <li><strong>Multiplayer:</strong> 2-8 hr√°ƒç≈Ø, 5 kol, ka≈æd√© kolo n√°hodn√° zemƒõ. Kdo prvn√≠ spr√°vnƒõ odpov√≠, dostane bod. Pokud nikdo neuhodne do 5 pokus≈Ø, kolo se p≈ôeskoƒç√≠.</li>
            </ul>
        </div>
        
        <div class="rule-box">
            <h3>üí° Strategie</h3>
            <ul>
                <li>Sleduj smƒõr j√≠zdy aut - v nƒõkter√Ωch zem√≠ch jezd√≠ vlevo, v jin√Ωch vpravo.</li>
                <li>V≈°√≠mej si jazyka na dopravn√≠ch znaƒçk√°ch nebo budov√°ch.</li>
                <li>Krajina ti hodnƒõ napov√≠ - pou≈°tƒõ, hory, pl√°≈æe, lesy.</li>
                <li>Pokud si nejsi jist√Ω, zkus obecn√Ω tip jako "Braz√≠lie" nebo "Rusko" podle kontinentu.</li>
            </ul>
        </div>
        
        <div class="rule-box">
            <h3>üìù Uzn√°van√© odpovƒõdi</h3>
            <ul>
                <li>Akceptujeme ƒçesk√© i anglick√© n√°zvy ("Francie" i "France")</li>
                <li>Zkr√°cen√© n√°zvy jsou OK ("USA" m√≠sto "Spojen√© st√°ty americk√©")</li>
                <li>Varianty s "Republika" nebo bez ("ƒåesko" = "ƒåesk√° republika")</li>
                <li>Hlavn√≠ mƒõsta NEakceptujeme - mus√≠≈° napsat zemi!</li>
            </ul>
        </div>
    </div>
</section>

<!-- HERNI SEKCE -->
<section class="section" id="game-section">
    <div class="container">
        <div class="section-title">
            <h2>Zaƒçni hr√°t</h2>
            <p>Vyber si hern√≠ m√≥d n√≠≈æe</p>
        </div>
        
        <div id="game-container">
            <!-- HLAVNI MENU -->
            <div id="main-menu" class="menu-panel">
                <div class="button-group">
                    <button class="btn btn-single" onclick="game.startSingle()">
                        üë§ Single Player - 5 minut
                    </button>
                    
                    <div style="margin: 30px 0; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 30px;">
                        <button class="btn btn-multi" onclick="game.showCreate()">
                            üéÆ Vytvo≈ôit multiplayer (Host)
                        </button>
                        <button class="btn btn-join" onclick="game.showJoin()">
                            üîó P≈ôipojit se k existuj√≠c√≠ h≈ôe
                        </button>
                    </div>
                </div>
                
                <div class="highscore-box">
                    <h3 style="margin-bottom: 15px; color: #818cf8;">üèÜ Nejlep≈°√≠ sk√≥re</h3>
                    <div id="highscore-list">
                        <div style="color: #64748b; text-align: center; padding: 20px;">
                            Zat√≠m ≈æ√°dn√© sk√≥re. Zahraj si singleplayer a uka≈æ co v tobƒõ je!
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- CREATE LOBBY -->
            <div id="create-lobby" class="lobby-panel" style="display: none;">
                <h2 style="text-align: center; margin-bottom: 30px;">Vytvo≈ôit novou hru</h2>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; color: #94a3b8;">V√Ωbƒõr kontinentu:</label>
                    <select id="continent-select" style="width: 100%; padding: 15px; border-radius: 10px; border: 2px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.3); color: white; font-size: 16px;">
                        <option value="world">üåç Cel√Ω svƒõt (194 zem√≠)</option>
                        <option value="europe">üá™üá∫ Evropa (46 zem√≠)</option>
                        <option value="asia">üåè Asie (49 zem√≠)</option>
                        <option value="americas">üåé Amerika (35 zem√≠)</option>
                        <option value="africa">üåç Afrika (54 zem√≠)</option>
                        <option value="oceania">üåè Oce√°nie (14 zem√≠)</option>
                    </select>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <label style="display: block; margin-bottom: 10px; color: #94a3b8;">Maxim√°ln√≠ poƒçet hr√°ƒç≈Ø:</label>
                    <select id="max-players" style="width: 100%; padding: 15px; border-radius: 10px; border: 2px solid rgba(255,255,255,0.1); background: rgba(0,0,0,0.3); color: white; font-size: 16px;">
                        <option value="2">2 hr√°ƒçi</option>
                        <option value="3">3 hr√°ƒçi</option>
                        <option value="4" selected>4 hr√°ƒçi</option>
                        <option value="5">5 hr√°ƒç≈Ø</option>
                        <option value="6">6 hr√°ƒç≈Ø</option>
                        <option value="7">7 hr√°ƒç≈Ø</option>
                        <option value="8">8 hr√°ƒç≈Ø</option>
                    </select>
                </div>
                
                <button class="btn btn-multi" onclick="game.createRoom()" style="margin-bottom: 15px;">
                    Vytvo≈ôit m√≠stnost
                </button>
                <button class="btn btn-secondary" onclick="game.showMain()">
                    Zpƒõt do menu
                </button>
            </div>
            
            <!-- HOST LOBBY -->
            <div id="host-lobby" class="lobby-panel" style="display: none;">
                <div style="text-align: center;">
                    <div style="color: #94a3b8; margin-bottom: 10px;">K√≥d pro p≈ôipojen√≠:</div>
                    <div class="code-display" id="room-code" onclick="game.copyCode()">----</div>
                    <div style="color: #64748b; font-size: 14px;">Klikni pro zkop√≠rov√°n√≠</div>
                </div>
                
                <div style="margin: 30px 0;">
                    <div style="color: #94a3b8; margin-bottom: 10px;">Hr√°ƒçi v m√≠stnosti:</div>
                    <div class="player-list" id="host-player-list">
                        <div class="player-item">
                            <span>Host (Ty)</span>
                            <span class="host-badge">HOST</span>
                        </div>
                    </div>
                </div>
                
                <div style="background: rgba(0,0,0,0.2); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <div id="host-chat" style="height: 120px; overflow-y: auto; margin-bottom: 15px; font-size: 14px; color: #cbd5e1;"></div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="host-chat-input" placeholder="Napi≈° zpr√°vu..." style="flex: 1; padding: 12px 20px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.2); background: rgba(0,0,0,0.3); color: white;" onkeypress="if(event.key==='Enter') game.sendChat('host')">
                        <button onclick="game.sendChat('host')" style="padding: 12px 25px; background: #818cf8; border: none; border-radius: 25px; color: white; font-weight: 600; cursor: pointer;">Poslat</button>
                    </div>
                </div>
                
                <button class="btn btn-start" id="start-game-btn" onclick="game.startGame()" style="display: none; margin-bottom: 15px;">
                    ‚ñ∂Ô∏è Spustit hru
                </button>
                <button class="btn btn-secondary" onclick="game.showMain()">
                    Zru≈°it hru
                </button>
            </div>
            
            <!-- JOIN LOBBY -->
            <div id="join-lobby" class="lobby-panel" style="display: none;">
                <h2 style="text-align: center; margin-bottom: 30px;">P≈ôipojit se ke h≈ôe</h2>
                
                <input type="text" id="join-code" placeholder="Zadej k√≥d m√≠stnosti" style="width: 100%; padding: 25px; font-size: 28px; text-align: center; letter-spacing: 3px; background: rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.2); border-radius: 12px; color: white; margin-bottom: 20px; text-transform: uppercase;">
                
                <input type="text" id="join-name" placeholder="Tvoje p≈ôezd√≠vka" style="width: 100%; padding: 20px; font-size: 18px; background: rgba(0,0,0,0.3); border: 2px solid rgba(255,255,255,0.2); border-radius: 12px; color: white; margin-bottom: 30px;">
                
                <button class="btn btn-join" onclick="game.joinRoom()" style="margin-bottom: 15px;">
                    P≈ôipojit se do hry
                </button>
                <button class="btn btn-secondary" onclick="game.showMain()">
                    Zpƒõt
                </button>
                
                <p id="join-error" style="color: #f43f5e; text-align: center; margin-top: 20px;"></p>
            </div>
            
            <!-- GUEST WAITING -->
            <div id="guest-wait" class="lobby-panel" style="display: none; text-align: center;">
                <div class="spinner" style="margin-bottom: 20px;"></div>
                <h2>P≈ôipojeno! ƒåek√°n√≠ na hosta...</h2>
                <p style="color: #94a3b8; margin: 20px 0;">Hra zaƒçne, jakmile host spust√≠ kolo.</p>
                
                <div class="player-list" id="guest-player-list" style="margin: 30px 0; text-align: left;"></div>
                
                <button class="btn btn-secondary" onclick="game.showMain()">
                    Odpojit se
                </button>
            </div>
            
            <!-- GAME PANEL -->
            <div id="game-panel">
                <div style="position: relative;">
                    <div id="map"></div>
                    <div id="map-loader">
                        <div class="spinner"></div>
                        <div style="color: white; margin-top: 10px;">Naƒç√≠t√°n√≠ mapy...</div>
                    </div>
                </div>
                
                <div class="controls">
                    <div class="stats-bar" id="game-stats">
                        <div class="stat-item" id="stat-timer" style="display: none;">
                            <div class="stat-label">Zb√Ωvaj√≠c√≠ ƒças</div>
                            <div class="stat-value" id="timer" style="color: #f43f5e;">05:00</div>
                        </div>
                        <div class="stat-item" id="stat-round" style="display: none;">
                            <div class="stat-label">Kolo</div>
                            <div class="stat-value" id="round">1/5</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">Sk√≥re</div>
                            <div class="stat-value" id="score">0</div>
                        </div>
                        <div class="stat-item" id="stat-countries" style="display: none;">
                            <div class="stat-label">Uhodnut√© zemƒõ</div>
                            <div class="stat-value" id="countries-count">0</div>
                        </div>
                    </div>
                    
                    <div style="position: relative;">
                        <div class="input-group">
                            <input type="text" id="guessInput" placeholder="Napi≈° n√°zev zemƒõ..." autocomplete="off" disabled>
                            <button class="action-btn" id="guessBtn" onclick="game.makeGuess()" disabled>H√°dat</button>
                        </div>
                        <div id="autocomplete-list" class="autocomplete-items"></div>
                    </div>
                    
                    <div id="hint" style="text-align: center; margin-top: 15px; font-size: 18px; min-height: 30px; color: #94a3b8;"></div>
                    
                    <button class="btn btn-secondary" onclick="game.backToMenu()" style="margin-top: 20px;">
                        ‚Ü© Ukonƒçit hru a vr√°tit se do menu
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- FOOTER -->
<footer style="background: #020617; padding: 40px 20px; text-align: center; color: #475569; border-top: 1px solid rgba(255,255,255,0.1);">
    <p style="margin-bottom: 10px;">¬© 2024 GeoGuessr Czech Edition</p>
    <p style="font-size: 14px;">Vytvo≈ôeno pro v≈°echny milovn√≠ky zemƒõpisu | Pou≈æ√≠v√° OpenStreetMap</p>
</footer>

<!-- GAME OVER MODAL -->
<div id="game-over" onclick="if(event.target === this) document.getElementById('game-over').style.display='none'">
    <div class="modal-content">
        <h2 id="go-title">Konec hry!</h2>
        <div id="go-results" style="margin: 30px 0;"></div>
        <button class="btn btn-single" onclick="game.newGame()" style="margin-bottom: 15px;">
            Hr√°t znovu
        </button>
        <button class="btn btn-secondary" onclick="game.showMain(); document.getElementById('game-over').style.display='none'">
            Hlavn√≠ menu
        </button>
    </div>
</div>

<script>
// Kompletn√≠ hern√≠ logika s v≈°emi 194 zemƒõmi
const game = (function() {
    'use strict';
    
    // Konstanty
    const HIGHSCORE_KEY = 'geoguessr_scores';
    const SINGLE_TIME = 300; // 5 minut
    
    // Detekce mobilu
    const isMobile = window.innerWidth <= 768;
    
    // Hern√≠ stav
    const state = {
        mode: null, // 'single', 'host', 'guest'
        roomCode: null,
        isHost: false,
        players: [],
        currentCountry: null,
        score: 0,
        countriesGuessed: 0,
        streak: 0,
        timeLeft: SINGLE_TIME,
        timerInterval: null,
        round: 1,
        totalRounds: 5,
        attempts: 0,
        socket: null,
        map: null,
        gameActive: false
    };
    
    // Kompletn√≠ datab√°ze 194 zem√≠
    const countries = [
        // Evropa (46)
        ["Alb√°nie",41.32,19.81,["albania"]],
        ["Andora",42.50,1.52,["andorra"]],
        ["Rakousko",48.20,16.37,["austria"]],
        ["Bƒõlorusko",53.90,27.56,["belarus"]],
        ["Belgie",50.85,4.35,["belgium"]],
        ["Bosna a Hercegovina",43.85,18.41,["bosnia","bosna"]],
        ["Bulharsko",42.69,23.32,["bulgaria"]],
        ["Chorvatsko",45.81,15.98,["croatia"]],
        ["Kypr",35.18,33.38,["cyprus"]],
        ["ƒåesko",50.07,14.43,["czech","cesko","czechia"]],
        ["D√°nsko",55.67,12.56,["denmark"]],
        ["Estonsko",59.43,24.75,["estonia"]],
        ["Finsko",60.16,24.93,["finland"]],
        ["Francie",48.85,2.35,["france"]],
        ["Nƒõmecko",52.52,13.40,["germany"]],
        ["≈òecko",37.98,23.72,["greece"]],
        ["Maƒèarsko",47.49,19.04,["hungary"]],
        ["Island",64.14,-21.94,["iceland"]],
        ["Irsko",53.34,-6.26,["ireland"]],
        ["It√°lie",41.90,12.49,["italy"]],
        ["Kosovo",42.66,21.16,["kosovo"]],
        ["Loty≈°sko",56.94,24.10,["latvia"]],
        ["Lichten≈°tejnsko",47.14,9.52,["liechtenstein"]],
        ["Litva",54.68,25.27,["lithuania"]],
        ["Lucembursko",49.61,6.13,["luxembourg"]],
        ["Malta",35.89,14.50,["malta"]],
        ["Moldavsko",47.01,28.86,["moldova"]],
        ["Monako",43.73,7.42,["monaco"]],
        ["ƒåern√° Hora",42.44,19.26,["montenegro"]],
        ["Nizozemsko",52.36,4.90,["netherlands"]],
        ["Severn√≠ Makedonie",41.99,21.43,["macedonia"]],
        ["Norsko",59.91,10.75,["norway"]],
        ["Polsko",52.22,21.01,["poland"]],
        ["Portugalsko",38.72,-9.13,["portugal"]],
        ["Rumunsko",44.42,26.10,["romania"]],
        ["Rusko",55.75,37.61,["russia"]],
        ["San Marino",43.94,12.46,["san marino"]],
        ["Srbsko",44.78,20.44,["serbia"]],
        ["Slovensko",48.14,17.10,["slovakia"]],
        ["Slovinsko",46.05,14.50,["slovenia"]],
        ["≈†panƒõlsko",40.41,-3.70,["spain"]],
        ["≈†v√©dsko",59.32,18.06,["sweden"]],
        ["≈†v√Ωcarsko",46.94,7.44,["switzerland"]],
        ["Ukrajina",50.45,30.52,["ukraine"]],
        ["Velk√° Brit√°nie",51.50,-0.12,["britain","uk","united kingdom"]],
        ["Vatik√°n",41.90,12.45,["vatican"]],
        
        // Asie (49)
        ["Afgh√°nist√°n",34.52,69.17,["afghanistan"]],
        ["Arm√©nie",40.17,44.50,["armenia"]],
        ["√Åzerb√°jd≈æ√°n",40.40,49.86,["azerbaijan"]],
        ["Bahrajn",26.22,50.58,["bahrain"]],
        ["Banglad√©≈°",23.81,90.41,["bangladesh"]],
        ["Bh√∫t√°n",27.51,90.43,["bhutan"]],
        ["Brunej",4.53,114.72,["brunei"]],
        ["Kambod≈æa",11.55,104.92,["cambodia"]],
        ["ƒå√≠na",35.86,104.19,["china"]],
        ["Georgie",41.71,44.82,["georgia"]],
        ["Indie",20.59,78.96,["india"]],
        ["Indon√©sie",-0.78,113.92,["indonesia"]],
        ["Ir√°n",32.42,53.68,["iran"]],
        ["Ir√°k",33.22,43.67,["iraq"]],
        ["Izrael",31.04,34.85,["israel"]],
        ["Japonsko",36.20,138.25,["japan"]],
        ["Jord√°nsko",30.58,36.23,["jordan"]],
        ["Kazachst√°n",48.01,66.92,["kazakhstan"]],
        ["Kuvajt",29.31,47.48,["kuwait"]],
        ["Kyrgyzst√°n",41.20,74.76,["kyrgyzstan"]],
        ["Laos",19.85,102.49,["laos"]],
        ["Libanon",33.85,35.86,["lebanon"]],
        ["Malajsie",4.21,101.97,["malaysia"]],
        ["Maledivy",3.20,73.22,["maldives"]],
        ["Mongolsko",46.86,103.84,["mongolia"]],
        ["Myanmar",21.91,95.95,["myanmar","burma"]],
        ["Nep√°l",28.39,84.12,["nepal"]],
        ["Korea (KLDR)",39.03,125.76,["north korea","kldr"]],
        ["Om√°n",21.47,55.97,["oman"]],
        ["P√°kist√°n",30.37,69.34,["pakistan"]],
        ["Palestina",31.95,35.23,["palestine"]],
        ["Filip√≠ny",12.87,121.77,["philippines"]],
        ["Katar",25.35,51.18,["qatar"]],
        ["Sa√∫dsk√° Ar√°bie",23.88,45.07,["saudi arabia"]],
        ["Singapur",1.35,103.81,["singapore"]],
        ["Korea (Ji≈æn√≠)",35.90,127.76,["south korea","korea"]],
        ["Sr√≠ Lanka",7.87,80.77,["sri lanka"]],
        ["S√Ωrie",34.80,38.99,["syria"]],
        ["T√°d≈æikist√°n",38.86,71.27,["tajikistan"]],
        ["Thajsko",15.87,100.99,["thailand"]],
        ["V√Ωchodn√≠ Timor",-8.87,125.72,["timor","east timor"]],
        ["Turecko",38.96,35.24,["turkey"]],
        ["Turkmenist√°n",38.96,59.56,["turkmenistan"]],
        ["Spojen√© arabsk√© emir√°ty",23.42,53.84,["uae","emirates"]],
        ["Uzbekist√°n",41.37,64.58,["uzbekistan"]],
        ["Vietnam",14.05,108.27,["vietnam"]],
        ["Jemen",15.55,48.51,["yemen"]],
        
        // Amerika (35)
        ["Antigua a Barbuda",17.06,-61.80,["antigua"]],
        ["Argentina",-38.41,-63.61,["argentina"]],
        ["Bahamy",25.03,-77.39,["bahamas"]],
        ["Barbados",13.19,-59.54,["barbados"]],
        ["Belize",17.18,-88.49,["belize"]],
        ["Bol√≠vie",-16.29,-63.58,["bolivia"]],
        ["Braz√≠lie",-14.23,-51.92,["brazil"]],
        ["Kanada",56.13,-106.34,["canada"]],
        ["Chile",-35.67,-71.54,["chile"]],
        ["Kolumbie",4.57,-74.29,["colombia"]],
        ["Kostarika",9.74,-83.75,["costa rica"]],
        ["Kuba",21.52,-77.78,["cuba"]],
        ["Dominika",15.41,-61.37,["dominica"]],
        ["Dominik√°nsk√° republika",18.73,-70.16,["dominican republic"]],
        ["Ekv√°dor",-1.83,-78.18,["ecuador"]],
        ["Salvador",13.79,-88.89,["el salvador"]],
        ["Grenada",12.26,-61.60,["grenada"]],
        ["Guatemala",15.78,-90.23,["guatemala"]],
        ["Guyana",4.86,-58.93,["guyana"]],
        ["Haiti",18.97,-72.28,["haiti"]],
        ["Honduras",15.19,-86.24,["honduras"]],
        ["Jamajka",18.10,-77.29,["jamaica"]],
        ["Mexiko",23.63,-102.55,["mexico"]],
        ["Nikaragua",12.86,-85.20,["nicaragua"]],
        ["Panama",8.53,-80.78,["panama"]],
        ["Paraguay",-23.44,-58.44,["paraguay"]],
        ["Peru",-9.19,-75.01,["peru"]],
        ["Svat√Ω Kry≈°tof a Nevis",17.35,-62.78,["saint kitts"]],
        ["Svat√° Lucie",13.90,-60.97,["saint lucia"]],
        ["Svat√Ω Vincenc a Grenadiny",13.25,-61.19,["saint vincent"]],
        ["Surinam",3.91,-56.02,["suriname"]],
        ["Trinidad a Tobago",10.69,-61.22,["trinidad"]],
        ["USA",37.09,-95.71,["usa","united states","america"]],
        ["Uruguay",-32.52,-55.76,["uruguay"]],
        ["Venezuela",6.42,-66.58,["venezuela"]],
        
        // Afrika (54)
        ["Al≈æ√≠rsko",28.03,1.65,["algeria"]],
        ["Angola",-11.20,17.87,["angola"]],
        ["Benin",9.30,2.31,["benin"]],
        ["Botswana",-22.32,24.68,["botswana"]],
        ["Burkina Faso",12.23,-1.56,["burkina faso"]],
        ["Burundi",-3.37,29.91,["burundi"]],
        ["Kamerun",7.36,12.35,["cameroon"]],
        ["Kapverdy",16.53,-23.56,["cape verde"]],
        ["St≈ôedoafrick√° republika",6.61,20.93,["central african republic"]],
        ["ƒåad",15.45,18.73,["chad"]],
        ["Komory",-11.64,43.33,["comoros"]],
        ["Kongo (DR)",-4.03,21.75,["dr congo","congo"]],
        ["Kongo",-0.22,15.82,["congo republic"]],
        ["D≈æibutsko",11.82,42.59,["djibouti"]],
        ["Egypt",26.20,30.80,["egypt"]],
        ["Rovn√≠kov√° Guinea",1.65,10.26,["equatorial guinea"]],
        ["Eritrea",15.17,39.78,["eritrea"]],
        ["Svazijsko",-26.52,31.46,["eswatini","swaziland"]],
        ["Etiopie",9.14,40.48,["ethiopia"]],
        ["Gabon",-0.80,11.60,["gabon"]],
        ["Gambie",13.44,-15.31,["gambia"]],
        ["Ghana",7.94,-1.02,["ghana"]],
        ["Guinea",9.94,-9.69,["guinea"]],
        ["Guinea-Bissau",11.80,-15.18,["guinea bissau"]],
        ["Pob≈ôe≈æ√≠ slonoviny",7.54,-5.54,["ivory coast"]],
        ["Ke≈àa",-0.02,37.90,["kenya"]],
        ["Lesotho",-29.61,28.23,["lesotho"]],
        ["Liberie",6.42,-9.42,["liberia"]],
        ["Libye",26.33,17.22,["libya"]],
        ["Madagaskar",-18.76,46.86,["madagascar"]],
        ["Malawi",-13.25,34.30,["malawi"]],
        ["Mali",17.57,-3.99,["mali"]],
        ["Maurit√°nie",21.00,-10.94,["mauritania"]],
        ["Mauricius",-20.34,57.55,["mauritius"]],
        ["Maroko",31.79,-7.09,["morocco"]],
        ["Mosambik",-18.66,35.52,["mozambique"]],
        ["Namibie",-22.95,18.49,["namibia"]],
        ["Niger",17.60,8.08,["niger"]],
        ["Nig√©rie",9.08,8.67,["nigeria"]],
        ["Rwanda",-1.94,29.87,["rwanda"]],
        ["Svat√Ω Tom√°≈° a Princ≈Øv ostrov",0.18,6.61,["sao tome"]],
        ["Senegal",14.49,-14.45,["senegal"]],
        ["Seychely",-4.67,55.46,["seychelles"]],
        ["Sierra Leone",8.46,-11.77,["sierra leone"]],
        ["Som√°lsko",5.15,46.19,["somalia"]],
        ["Ji≈æn√≠ Afrika",-30.55,22.93,["south africa"]],
        ["Ji≈æn√≠ S√∫d√°n",6.87,31.30,["south sudan"]],
        ["S√∫d√°n",12.86,30.21,["sudan"]],
        ["Tanz√°nie",-6.36,34.88,["tanzania"]],
        ["Togo",8.61,0.82,["togo"]],
        ["Tunisko",33.88,9.53,["tunisia"]],
        ["Uganda",1.37,32.29,["uganda"]],
        ["Zambie",-13.13,27.85,["zambia"]],
        ["Zimbabwe",-19.01,29.15,["zimbabwe"]],
        
        // Oce√°nie (14)
        ["Austr√°lie",-25.27,133.77,["australia"]],
        ["Fid≈æi",-17.71,178.06,["fiji"]],
        ["Kiribati",-3.37,-168.73,["kiribati"]],
        ["Marshallovy ostrovy",7.13,171.18,["marshall islands"]],
        ["Mikron√©sie",7.42,150.55,["micronesia"]],
        ["Nauru",-0.52,166.93,["nauru"]],
        ["Nov√Ω Z√©land",-40.90,174.88,["new zealand"]],
        ["Palau",7.51,134.58,["palau"]],
        ["Papua Nov√° Guinea",-6.31,143.95,["papua new guinea"]],
        ["Samoa",-13.75,-172.10,["samoa"]],
        ["≈†alomounovy ostrovy",-9.64,160.15,["solomon islands"]],
        ["Tonga",-21.17,-175.20,["tonga"]],
        ["Tuvalu",-7.10,179.15,["tuvalu"]],
        ["Vanuatu",-15.37,166.95,["vanuatu"]]
    ];
    
    // Socket.io connection (pokud je server dostupn√Ω)
    let socket = null;
    try {
        socket = io();
    } catch(e) {
        console.log('Socket.io nen√≠ dostupn√Ω - offline m√≥d');
    }
    
    // Pomocn√© funkce
    function showToast(msg) {
        const toast = document.createElement('div');
        toast.style.cssText = 'position:fixed;bottom:30px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.9);color:white;padding:15px 30px;border-radius:50px;z-index:10000;border:1px solid rgba(255,255,255,0.2)';
        toast.textContent = msg;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
    }
    
    function normalize(str) {
        return str.toLowerCase()
            .normalize("NFD")
            .replace(/[\u0300-\u036f]/g, "")
            .replace(/[^a-z0-9]/g, "");
    }
    
    // High Score funkce
    function loadHighScores() {
        try {
            return JSON.parse(localStorage.getItem(HIGHSCORE_KEY)) || [];
        } catch(e) {
            return [];
        }
    }
    
    function saveHighScore(name, score, countries) {
        const scores = loadHighScores();
        scores.push({name: name || 'Anonymous', score, countries, date: new Date().toISOString()});
        scores.sort((a,b) => b.score - a.score);
        scores.splice(10); // max 10
        localStorage.setItem(HIGHSCORE_KEY, JSON.stringify(scores));
        updateHighScoreDisplay();
    }
    
    function updateHighScoreDisplay() {
        const list = document.getElementById('highscore-list');
        const scores = loadHighScores();
        
        if(scores.length === 0) {
            list.innerHTML = '<div style="color:#64748b;text-align:center;padding:20px;">Zat√≠m ≈æ√°dn√© sk√≥re. Zahraj si singleplayer!</div>';
            return;
        }
        
        list.innerHTML = scores.map((s,i) => `
            <div class="highscore-item">
                <span>${i+1}. ${s.name}</span>
                <span style="color:#818cf8;font-weight:bold">${s.score} bod≈Ø</span>
            </div>
        `).join('');
    }
    
    // Map funkce
    function initMap(lat, lng, zoom = 16) {
        if(state.map) {
            state.map.remove();
        }
        
        const mapEl = document.getElementById('map');
        if(!mapEl) return;
        
        state.map = L.map('map', {
            zoomControl: false,
            attributionControl: false,
            dragging: false,
            scrollWheelZoom: false,
            doubleClickZoom: false,
            keyboard: false
        }).setView([lat, lng], zoom);
        
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            crossOrigin: true
        }).addTo(state.map);
    }
    
    function zoomOut() {
        if(!state.map || !state.currentCountry) return;
        const zooms = [16, 13, 10, 6, 3];
        const currentZoom = state.map.getZoom();
        const idx = zooms.indexOf(currentZoom);
        const newZoom = zooms[Math.min(idx + 1, zooms.length - 1)];
        state.map.setView([state.currentCountry[1], state.currentCountry[2]], newZoom);
    }
    
    // Hra funkce
    function nextCountry() {
        // Vyber n√°hodnou zemi
        const prev = state.currentCountry;
        let next;
        do {
            next = countries[Math.floor(Math.random() * countries.length)];
        } while(next === prev && countries.length > 1);
        
        state.currentCountry = next;
        state.attempts = 0;
        
        // Zobraz mapu
        document.getElementById('map-loader').style.display = 'none';
        initMap(next[1], next[2], 16);
        
        // Povol input
        document.getElementById('guessInput').disabled = false;
        document.getElementById('guessBtn').disabled = false;
        document.getElementById('guessInput').value = '';
        document.getElementById('guessInput').focus();
        updateHint();
    }
    
    function updateHint() {
        const labels = ["Velmi detailn√≠", "Detailn√≠", "Mƒõsto", "Region", "Cel√° zemƒõ"];
        const hint = document.getElementById('hint');
        hint.textContent = `Pokus ${state.attempts + 1}/5 - ${labels[state.attempts] || 'Posledn√≠ ≈°ance'}`;
        hint.className = '';
    }
    
    function makeGuess() {
        const input = document.getElementById('guessInput');
        const val = input.value.trim();
        if(!val) return;
        
        const normVal = normalize(val);
        const country = state.currentCountry;
        const correct = normalize(country[0]) === normVal || 
                       country[3].some(alt => normalize(alt) === normVal);
        
        if(correct) {
            // Spr√°vnƒõ
            const points = 50 - (state.attempts * 10);
            state.score += points;
            state.countriesGuessed++;
            state.streak++;
            
            document.getElementById('score').textContent = state.score;
            document.getElementById('countries-count').textContent = state.countriesGuessed;
            
            const hint = document.getElementById('hint');
            hint.innerHTML = `‚úì Spr√°vnƒõ! ${country[0]} <span style="color:#fbbf24">+${points} bod≈Ø</span>`;
            hint.className = 'success';
            
            document.getElementById('guessInput').disabled = true;
            document.getElementById('guessBtn').disabled = true;
            
            if(state.mode === 'single' && state.timeLeft > 0) {
                setTimeout(nextCountry, 1500);
            } else {
                setTimeout(endGame, 1500);
            }
        } else {
            // ≈†patnƒõ
            state.attempts++;
            state.streak = 0;
            
            if(state.attempts >= 5) {
                const hint = document.getElementById('hint');
                hint.innerHTML = `‚úó Spr√°vn√° odpovƒõƒè: <strong>${country[0]}</strong>`;
                hint.className = 'fail';
                
                document.getElementById('guessInput').disabled = true;
                document.getElementById('guessBtn').disabled = true;
                
                if(state.mode === 'single' && state.timeLeft > 0) {
                    setTimeout(nextCountry, 2000);
                }
            } else {
                zoomOut();
                updateHint();
                input.classList.add('shake');
                setTimeout(() => input.classList.remove('shake'), 500);
            }
        }
        
        // Skryj autocomplete
        document.getElementById('autocomplete-list').style.display = 'none';
    }
    
    function endGame() {
        clearInterval(state.timerInterval);
        state.gameActive = false;
        
        const modal = document.getElementById('game-over');
        const title = document.getElementById('go-title');
        const results = document.getElementById('go-results');
        
        title.textContent = state.mode === 'single' ? 'ƒåas vypr≈°el!' : 'Konec hry!';
        
        if(state.mode === 'single') {
            results.innerHTML = `
                <div class="score-row">
                    <span>Celkov√© sk√≥re:</span>
                    <span style="font-size:24px;color:#818cf8;font-weight:bold">${state.score}</span>
                </div>
                <div class="score-row">
                    <span>Uhodnut√Ωch zem√≠:</span>
                    <span>${state.countriesGuessed}</span>
                </div>
                <div class="score-row">
                    <span>Nejvy≈°≈°√≠ s√©rie:</span>
                    <span>${state.streak}</span>
                </div>
            `;
            
            // Ulo≈æ sk√≥re
            const name = prompt(`Gratulace! Z√≠skal jsi ${state.score} bod≈Ø.\nZadej svoje jm√©no pro ≈æeb≈ô√≠ƒçek:`);
            if(name) saveHighScore(name, state.score, state.countriesGuessed);
        } else {
            // Multiplayer results
            results.innerHTML = '<div style="text-align:left">Multiplayer v√Ωsledky...</div>';
        }
        
        modal.style.display = 'flex';
    }
    
    // Timer pro singleplayer
    function startTimer() {
        state.timeLeft = SINGLE_TIME;
        updateTimerDisplay();
        
        state.timerInterval = setInterval(() => {
            state.timeLeft--;
            updateTimerDisplay();
            
            if(state.timeLeft <= 0) {
                endGame();
            }
        }, 1000);
    }
    
    function updateTimerDisplay() {
        const min = Math.floor(state.timeLeft / 60);
        const sec = state.timeLeft % 60;
        document.getElementById('timer').textContent = 
            `${min.toString().padStart(2,'0')}:${sec.toString().padStart(2,'0')}`;
    }
    
    // Autocomplete
    function setupAutocomplete() {
        const input = document.getElementById('guessInput');
        const list = document.getElementById('autocomplete-list');
        
        input.addEventListener('input', (e) => {
            const val = e.target.value;
            if(!val) {
                list.style.display = 'none';
                return;
            }
            
            const norm = normalize(val);
            const matches = countries.filter(c => 
                normalize(c[0]).includes(norm) || 
                c[3].some(a => normalize(a).includes(norm))
            ).slice(0, 5);
            
            if(matches.length === 0) {
                list.style.display = 'none';
                return;
            }
            
            list.innerHTML = matches.map(c => `
                <div class="autocomplete-item" onclick="game.selectCountry('${c[0]}')">
                    ${c[0].replace(new RegExp(val, 'gi'), match => `<strong>${match}</strong>`)}
                </div>
            `).join('');
            
            list.style.display = 'block';
        });
        
        // Skryj p≈ôi kliknut√≠ mimo
        document.addEventListener('click', (e) => {
            if(e.target !== input) list.style.display = 'none';
        });
    }
    
    // Socket.io eventy (pokud je p≈ôipojen√≠)
    if(socket) {
        socket.on('connect', () => {
            console.log('P≈ôipojeno k serveru');
        });
        
        socket.on('room-created', (data) => {
            state.roomCode = data.code;
            document.getElementById('room-code').textContent = data.code;
            document.getElementById('create-lobby').style.display = 'none';
            document.getElementById('host-lobby').style.display = 'block';
        });
        
        socket.on('player-joined', (data) => {
            showToast(`${data.name} se p≈ôipojil!`);
            // Update player list...
        });
    }
    
    // Ve≈ôejn√© metody
    return {
        init: function() {
            updateHighScoreDisplay();
            setupAutocomplete();
            
            // Pokud je v URL k√≥d, rovnou zobraz join
            const urlParams = new URLSearchParams(window.location.search);
            const room = urlParams.get('room');
            if(room) {
                document.getElementById('main-menu').style.display = 'none';
                document.getElementById('join-lobby').style.display = 'block';
                document.getElementById('join-code').value = room;
            }
        },
        
        showMain: function() {
            document.querySelectorAll('.menu-panel, .lobby-panel, #game-panel').forEach(el => {
                el.style.display = 'none';
            });
            document.getElementById('main-menu').style.display = 'block';
            document.getElementById('game-section').scrollIntoView({behavior: 'smooth'});
            
            // Ukonƒçi hru pokud bƒõ≈æ√≠
            clearInterval(state.timerInterval);
            state.gameActive = false;
        },
        
        showCreate: function() {
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('create-lobby').style.display = 'block';
        },
        
        showJoin: function() {
            document.getElementById('main-menu').style.display = 'none';
            document.getElementById('join-lobby').style.display = 'block';
        },
        
        createRoom: function() {
            const continent = document.getElementById('continent-select').value;
            const maxPlayers = document.getElementById('max-players').value;
            
            if(socket) {
                socket.emit('create-room', {continent, maxPlayers});
            } else {
                // Offline simulace
                const code = Math.random().toString(36).substring(2, 8).toUpperCase();
                state.roomCode = code;
                state.isHost = true;
                document.getElementById('room-code').textContent = code;
                document.getElementById('create-lobby').style.display = 'none';
                document.getElementById('host-lobby').style.display = 'block';
                showToast('M√≠stnost vytvo≈ôena! K√≥d: ' + code);
            }
        },
        
        joinRoom: function() {
            const code = document.getElementById('join-code').value.trim();
            const name = document.getElementById('join-name').value.trim() || 'Hr√°ƒç';
            
            if(!code) {
                document.getElementById('join-error').textContent = 'Zadej k√≥d m√≠stnosti!';
                return;
            }
            
            if(socket) {
                socket.emit('join-room', {code, name});
            } else {
                document.getElementById('join-lobby').style.display = 'none';
                document.getElementById('guest-wait').style.display = 'block';
                showToast('P≈ôipojuji se k ' + code + '...');
            }
        },
        
        startSingle: function() {
            state.mode = 'single';
            state.score = 0;
            state.countriesGuessed = 0;
            state.streak = 0;
            state.gameActive = true;
            
            // UI p≈ôepnut√≠
            document.querySelectorAll('.menu-panel, .lobby-panel').forEach(el => el.style.display = 'none');
            document.getElementById('game-panel').style.display = 'block';
            document.getElementById('stat-timer').style.display = 'block';
            document.getElementById('stat-countries').style.display = 'block';
            document.getElementById('stat-round').style.display = 'none';
            
            document.getElementById('game-section').scrollIntoView({behavior: 'smooth'});
            
            // Start
            nextCountry();
            startTimer();
        },
        
        startGame: function() {
            if(socket) socket.emit('start-game');
            showToast('Hra zaƒç√≠n√°!');
        },
        
        makeGuess: makeGuess,
        
        selectCountry: function(name) {
            document.getElementById('guessInput').value = name;
            document.getElementById('autocomplete-list').style.display = 'none';
            makeGuess();
        },
        
        copyCode: function() {
            const code = document.getElementById('room-code').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showToast('K√≥d zkop√≠rov√°n do schr√°nky!');
            });
        },
        
        sendChat: function(role) {
            const input = document.getElementById(role + '-chat-input');
            const msg = input.value.trim();
            if(!msg) return;
            
            const chat = document.getElementById(role + '-chat');
            chat.innerHTML += `<div style="margin-bottom:8px"><strong style="color:#818cf8">Ty:</strong> ${msg}</div>`;
            chat.scrollTop = chat.scrollHeight;
            input.value = '';
            
            if(socket) socket.emit('chat', {room: state.roomCode, message: msg});
        },
        
        backToMenu: function() {
            if(confirm('Opravdu chce≈° ukonƒçit hru?')) {
                this.showMain();
            }
        },
        
        newGame: function() {
            document.getElementById('game-over').style.display = 'none';
            if(state.mode === 'single') {
                this.startSingle();
            } else {
                this.showMain();
            }
        }
    };
})();

// Inicializace p≈ôi naƒçten√≠
document.addEventListener('DOMContentLoaded', () => {
    game.init();
});
</script>

</body>
</html>
